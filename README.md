# Kodiアドオン：iTunesプレイリストコンバータ

iTunesプレイリストコンバータは、iTunesが出力するライブラリを、Kodiのプレイリストファイル（m3uファイル）に変換する機能、および、HTMLファイル（htmlファイル、サンプルは[こちら](sample/playlist.html)）に変換する機能を提供します。[itunestom3u](https://code.google.com/p/itunestom3u/)を参考にしました。

アドオン設定画面の「一般設定」「HTML変換設定」で設定を行った後、アドオンを起動すると、一般設定、HTML変換設定にしたがって変換を開始します。
変換はバックグラウンドで実行され、実行が完了すると画面に通知されます。処理対象が大量にある場合は、変換に数分かかることがあります。
「実行」の都度、古いファイルは削除され、新しいファイルが生成されます。


## 一般設定

![アドオン設定画面（一般設定）](https://user-images.githubusercontent.com/12268536/230531138-b36f9353-6a8d-46ab-bc54-49ee69266e7e.png)

### ライブラリ.xmlへのパス

iTunesライブラリ（xmlファイル）へのパスを設定してください。
xmlファイルは、iTunesのメニューで、ファイル→ライブラリ→ライブラリを書き出し… を選択して出力できます。
デフォルトのファイル名は、ライブラリ.xml です（macOSの以前のiTunesでは、/Users/(username)/Music/iTunes/iTunes Music Library.xml に自動出力されていました）。
アドオンは、ここで設定したxmlファイルを解析して変換処理を行います。

### ファイルパスを変換する

Kodiのプレイリストファイル（m3uファイル）に出力するコンテンツのファイルパスの形式が、ライブラリ.xmlに記述されているファイルパスの形式と異なる場合（ファイルパスの文字列を一部他の文字列と置換する必要がある場合）は、これをチェックしてください。

### 変換前のパス、変換後のパス

置換すべき文字列の部分と、これを置換する文字列をそれぞれ設定してください。
私の環境では、以下の設定で変換ができていますが、OSやiTunesのバージョン、iTunesの設定で差異があるかもしれないので注意してください。

|OS|変換前のパス|変換後のパス|
|:---|:---|:---|
|Windows 7|file://localhost/||
|Windows 10|file://localhost/||
|macOS|file://||


## HTML変換設定

![アドオン設定画面（HTML変換設定）](https://user-images.githubusercontent.com/12268536/230531305-10e9bd8e-d66f-40fd-8604-3be0bd37c597.png)

### プレイリストをHTMLに変換する

HTMLファイルを生成する場合は、これをチェックしてください。

### HTMLプレイリストのディレクトリへのパス

生成されたHTMLファイルを書き込むルートディレクトリを設定してください。
